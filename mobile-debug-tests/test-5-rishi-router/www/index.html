<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test 5: Rishi + Router</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-router-dom@6/dist/umd/react-router-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, Arial, sans-serif; background: #f5f5f5; }
        
        /* Debug Console */
        .debug { position: fixed; bottom: 0; left: 0; right: 0; background: black; color: lime; 
                 padding: 10px; font-family: monospace; font-size: 11px; max-height: 150px; 
                 overflow-y: auto; z-index: 1000; border-top: 2px solid lime; }
        
        /* Header */
        .header { background: #1e3c72; color: white; padding: 15px; display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 24px; font-weight: bold; }
        .user-menu { display: flex; gap: 10px; align-items: center; }
        
        /* Navigation */
        .nav { background: #2a5298; color: white; padding: 10px; }
        .nav a { color: white; text-decoration: none; padding: 8px 15px; margin-right: 10px; border-radius: 4px; }
        .nav a:hover { background: rgba(255,255,255,0.1); }
        .nav a.active { background: rgba(255,255,255,0.2); font-weight: bold; }
        
        /* Content */
        .content { padding: 20px; max-width: 1200px; margin: 0 auto; margin-bottom: 170px; }
        .page-title { font-size: 28px; margin-bottom: 20px; color: #333; }
        
        /* Cards */
        .card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .card h2 { font-size: 20px; margin-bottom: 15px; color: #1e3c72; }
        
        /* Buttons */
        .btn { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        .btn-primary { background: #1e3c72; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        
        /* Grid */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        
        /* Status indicators */
        .status { padding: 5px 10px; border-radius: 4px; font-size: 12px; }
        .status.success { background: #d4edda; color: #155724; }
        .status.router { background: #e7f3ff; color: #0066cc; }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .nav a { font-size: 14px; padding: 6px 10px; }
            .content { padding: 15px; }
            .grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div id="debug" class="debug">Debug Console (React Router Test):</div>
    
    <script>
        // Enhanced debug logging
        window.debugLog = function(msg) {
            const debug = document.getElementById('debug');
            const time = new Date().toTimeString().split(' ')[0];
            debug.innerHTML += '<br>' + time + ' - ' + msg;
            debug.scrollTop = debug.scrollHeight;
            console.log('DEBUG:', msg);
        };
        
        // Comprehensive error handling
        window.onerror = function(msg, url, line, col, error) {
            debugLog('ERROR: ' + msg + ' at line ' + line);
            return true;
        };
        
        window.addEventListener('unhandledrejection', function(event) {
            debugLog('PROMISE ERROR: ' + event.reason);
        });
        
        debugLog('=== RISHI PLATFORM + REACT ROUTER TEST ===');
        debugLog('React: ' + (window.React ? 'Loaded' : 'Missing'));
        debugLog('ReactDOM: ' + (window.ReactDOM ? 'Loaded' : 'Missing'));
        debugLog('ReactRouter: ' + (window.ReactRouterDOM ? 'Loaded' : 'Missing'));
        debugLog('User Agent: ' + navigator.userAgent.substring(0, 60) + '...');
        debugLog('Location: ' + window.location.href);
    </script>
    
    <script type="text/babel">
        debugLog('Starting React Router Rishi Platform...');
        
        try {
            const { BrowserRouter, Routes, Route, Link, useLocation, useNavigate } = ReactRouterDOM;
            const { useState, useEffect } = React;
            const e = React.createElement;
            
            // Mock data
            const mockBookings = [
                { id: 1, client: 'Client A', date: '2025-07-26', status: 'confirmed' },
                { id: 2, client: 'Client B', date: '2025-07-27', status: 'pending' }
            ];
            
            const mockStaff = [
                { id: 1, name: 'John Doe', role: 'Field Agent', status: 'active' },
                { id: 2, name: 'Jane Smith', role: 'Manager', status: 'active' }
            ];
            
            // Location tracker component
            function LocationTracker() {
                const location = useLocation();
                
                useEffect(() => {
                    debugLog('Router navigated to: ' + location.pathname);
                    debugLog('Current search: ' + location.search);
                    debugLog('Current hash: ' + location.hash);
                }, [location]);
                
                return React.createElement('div', {
                    className: 'status router',
                    style: { position: 'fixed', top: '10px', right: '10px', zIndex: 999 }
                }, 'Route: ' + location.pathname);
            }
            
            // Dashboard Component
            function Dashboard() {
                useEffect(() => {
                    debugLog('Dashboard component mounted');
                }, []);
                
                return e('div', null,
                    e('h1', {className: 'page-title'}, 'Dashboard'),
                    e('div', {className: 'status success'}, 'React Router Navigation Working!'),
                    e('div', {className: 'grid'},
                        e('div', {className: 'card'},
                            e('h2', null, '📅 Today\'s Bookings'),
                            e('p', null, '5 bookings scheduled'),
                            e(Link, {to: '/bookings', className: 'btn btn-primary'}, 'View All Bookings')
                        ),
                        e('div', {className: 'card'},
                            e('h2', null, '👥 Active Staff'),
                            e('p', null, '12 staff members on duty'),
                            e(Link, {to: '/staff', className: 'btn btn-primary'}, 'Manage Staff')
                        ),
                        e('div', {className: 'card'},
                            e('h2', null, '📍 Locations'),
                            e('p', null, '8 active locations'),
                            e('button', {className: 'btn btn-primary'}, 'View Map')
                        ),
                        e('div', {className: 'card'},
                            e('h2', null, '📦 Inventory'),
                            e('p', null, '156 items in stock'),
                            e('button', {className: 'btn btn-primary'}, 'Manage Inventory')
                        )
                    )
                );
            }
            
            // Bookings Component
            function Bookings() {
                useEffect(() => {
                    debugLog('Bookings component mounted');
                }, []);
                
                return e('div', null,
                    e('h1', {className: 'page-title'}, 'Bookings Management'),
                    e('div', {className: 'status success'}, 'Router navigation successful!'),
                    e('div', {className: 'card'},
                        e('button', {className: 'btn btn-primary', style: {marginBottom: '15px'}}, '+ New Booking'),
                        e('table', {style: {width: '100%'}},
                            e('thead', null,
                                e('tr', null,
                                    e('th', {style: {textAlign: 'left', padding: '10px'}}, 'Client'),
                                    e('th', {style: {textAlign: 'left', padding: '10px'}}, 'Date'),
                                    e('th', {style: {textAlign: 'left', padding: '10px'}}, 'Status')
                                )
                            ),
                            e('tbody', null,
                                mockBookings.map(booking =>
                                    e('tr', {key: booking.id},
                                        e('td', {style: {padding: '10px'}}, booking.client),
                                        e('td', {style: {padding: '10px'}}, booking.date),
                                        e('td', {style: {padding: '10px'}}, booking.status)
                                    )
                                )
                            )
                        )
                    )
                );
            }
            
            // Staff Component
            function Staff() {
                useEffect(() => {
                    debugLog('Staff component mounted');
                }, []);
                
                return e('div', null,
                    e('h1', {className: 'page-title'}, 'Staff Management'),
                    e('div', {className: 'status success'}, 'Staff page loaded via React Router'),
                    e('div', {className: 'card'},
                        e('button', {className: 'btn btn-primary', style: {marginBottom: '15px'}}, '+ Add Staff'),
                        e('div', {className: 'grid'},
                            mockStaff.map(member =>
                                e('div', {key: member.id, className: 'card'},
                                    e('h3', null, member.name),
                                    e('p', null, member.role),
                                    e('span', {className: 'status success'}, member.status)
                                )
                            )
                        )
                    )
                );
            }
            
            // Settings Component
            function Settings() {
                useEffect(() => {
                    debugLog('Settings component mounted');
                }, []);
                
                return e('div', null,
                    e('h1', {className: 'page-title'}, 'Settings'),
                    e('div', {className: 'status success'}, 'Settings accessible via router'),
                    e('div', {className: 'card'},
                        e('h2', null, 'Organization Settings'),
                        e('div', {style: {marginBottom: '15px'}},
                            e('label', {style: {display: 'block', marginBottom: '5px'}}, 'Organization Name'),
                            e('input', {type: 'text', defaultValue: 'Rishi Platform', style: {width: '100%', padding: '8px'}})
                        ),
                        e('div', {style: {marginBottom: '15px'}},
                            e('label', {style: {display: 'block', marginBottom: '5px'}}, 'Time Zone'),
                            e('select', {style: {width: '100%', padding: '8px'}},
                                e('option', null, 'Pacific Time'),
                                e('option', null, 'Mountain Time'),
                                e('option', null, 'Central Time'),
                                e('option', null, 'Eastern Time')
                            )
                        ),
                        e('button', {className: 'btn btn-primary'}, 'Save Settings')
                    )
                );
            }
            
            // Main App Component with React Router
            function App() {
                const [user] = useState({ name: 'Admin User', role: 'super_admin' });
                
                useEffect(() => {
                    debugLog('Main App component mounted with React Router');
                    debugLog('Initial location: ' + window.location.pathname);
                }, []);
                
                return e(BrowserRouter, null,
                    e(LocationTracker),
                    
                    // Header
                    e('div', {className: 'header'},
                        e('div', {className: 'logo'}, '🌿 Rishi Platform'),
                        e('div', {className: 'user-menu'},
                            e('span', null, user.name),
                            e('button', {className: 'btn btn-secondary', onClick: () => alert('Logout')}, 'Logout')
                        )
                    ),
                    
                    // Navigation with React Router Links
                    e('nav', {className: 'nav'},
                        e(Link, {to: '/'}, 'Dashboard'),
                        e(Link, {to: '/bookings'}, 'Bookings'),
                        e(Link, {to: '/staff'}, 'Staff'),
                        e(Link, {to: '/settings'}, 'Settings')
                    ),
                    
                    // Content with Routes
                    e('div', {className: 'content'},
                        e(Routes, null,
                            e(Route, {path: '/', element: e(Dashboard)}),
                            e(Route, {path: '/bookings', element: e(Bookings)}),
                            e(Route, {path: '/staff', element: e(Staff)}),
                            e(Route, {path: '/settings', element: e(Settings)})
                        )
                    )
                );
            }
            
            // Render the app
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(e(App));
            debugLog('✅ React Router Rishi Platform rendered successfully!');
            debugLog('Navigation should work with Link components');
            
        } catch(err) {
            debugLog('❌ FATAL ERROR: ' + err.message);
            debugLog('Error stack: ' + (err.stack || 'No stack trace'));
            document.getElementById('root').innerHTML = 
                '<div style="color:red; padding:20px; font-size:18px;">Failed to load: ' + err.message + '</div>';
        }
    </script>
</body>
</html>